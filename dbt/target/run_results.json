{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.3", "generated_at": "2026-02-08T20:09:16.694261Z", "invocation_id": "b6664a34-8069-44a6-be8a-bff2de057be2", "invocation_started_at": "2026-02-08T20:09:05.811286Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-08T20:09:11.673695Z", "completed_at": "2026-02-08T20:09:11.680778Z"}, {"name": "execute", "started_at": "2026-02-08T20:09:11.681110Z", "completed_at": "2026-02-08T20:09:16.607562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.936902046203613, "adapter_response": {"_message": "CREATE TABLE (37.0 rows, 193.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 37, "bytes_processed": 202751302, "bytes_billed": 203423744, "location": "europe-west4", "project_id": "stellar-stream-485314-p0", "job_id": "1e033e2b-b7a6-45eb-995a-3743bcbe6574", "slot_ms": 29529}, "message": "CREATE TABLE (37.0 rows, 193.4 MiB processed)", "failures": null, "unique_id": "model.supply_chain_project.customer_retention_rate", "compiled": true, "compiled_code": "\n\nWITH month_names AS (\n    SELECT 1 AS month_num, 'January' AS month_name UNION ALL\n    SELECT 2, 'February' UNION ALL\n    SELECT 3, 'March' UNION ALL\n    SELECT 4, 'April' UNION ALL\n    SELECT 5, 'May' UNION ALL\n    SELECT 6, 'June' UNION ALL\n    SELECT 7, 'July' UNION ALL\n    SELECT 8, 'August' UNION ALL\n    SELECT 9, 'September' UNION ALL\n    SELECT 10, 'October' UNION ALL\n    SELECT 11, 'November' UNION ALL\n    SELECT 12, 'December'\n), \nmonthly_customers AS (\n    SELECT\n        EXTRACT(YEAR FROM PARSE_TIMESTAMP('%m/%d/%Y %H:%M', order_date)) AS year,\n        EXTRACT(MONTH FROM PARSE_TIMESTAMP('%m/%d/%Y %H:%M', order_date)) AS month,\n        COUNT(DISTINCT order_customer_id) AS distinct_customers\n    FROM\n        `stellar-stream-485314-p0`.`supply_chain_dbt_dev_staging`.`dim_order`\n    GROUP BY\n        year, month\n),\n-- \u7b2c\u4e00\u6b65\uff1a\u5148\u8ba1\u7b97\u7d2f\u79ef\u503c\ncumulative_base AS (\n    SELECT\n        year,\n        month,\n        distinct_customers,\n        SUM(distinct_customers) OVER (ORDER BY year, month) AS cumulative_customers\n    FROM\n        monthly_customers\n),\n-- \u7b2c\u4e8c\u6b65\uff1a\u518d\u5bf9\u8ba1\u7b97\u51fa\u7684\u7d2f\u79ef\u503c\u6267\u884c LAG\nretention_metrics AS (\n    SELECT\n        *,\n        LAG(cumulative_customers) OVER (ORDER BY year, month) AS prev_cumulative_customers\n    FROM\n        cumulative_base\n)\n\nSELECT\n    m.year,\n    mo.month_name,\n    m.distinct_customers,\n    m.cumulative_customers,\n    CASE \n        WHEN m.prev_cumulative_customers IS NULL THEN 1.0\n        ELSE ROUND(m.prev_cumulative_customers / NULLIF(m.cumulative_customers, 0), 2)\n    END as customer_retention_rate\nFROM\n    retention_metrics m\nJOIN month_names mo ON m.month = mo.month_num\nORDER BY\n    m.year, m.month", "relation_name": "`stellar-stream-485314-p0`.`supply_chain_dbt_dev_marts`.`customer_retention_rate`", "batch_results": null}], "elapsed_time": 6.0722057819366455, "args": {"log_level": "info", "send_anonymous_usage_stats": true, "use_colors_file": true, "print": true, "select": ["customer_retention_rate"], "validate_macro_args": false, "favor_state": false, "indirect_selection": "eager", "require_all_warnings_handled_by_warn_error": false, "project_dir": "/Users/liceline/Documents/study_material/data_engineer/project_study/supply_chain/supply_chain_de_study/dbt", "exclude": [], "log_path": "/Users/liceline/Documents/study_material/data_engineer/project_study/supply_chain/supply_chain_de_study/dbt/logs", "populate_cache": true, "macro_debugging": false, "vars": {}, "show_resource_report": false, "require_generic_test_arguments_property": true, "version_check": true, "log_level_file": "debug", "require_nested_cumulative_type_params": false, "require_resource_names_without_spaces": true, "source_freshness_run_project_hooks": true, "defer": false, "empty": false, "log_format": "default", "use_colors": true, "use_fast_test_edges": false, "printer_width": 80, "cache_selected_only": false, "partial_parse_file_diff": true, "upload_to_artifacts_ingest_api": false, "log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "static_parser": true, "require_unique_project_resource_names": false, "which": "run", "strict_mode": false, "skip_nodes_if_on_run_start_fails": false, "invocation_command": "dbt run --select customer_retention_rate", "require_explicit_package_overrides_for_builtin_materializations": true, "quiet": false, "introspect": true, "write_json": true, "partial_parse": true, "profiles_dir": "/Users/liceline/Documents/study_material/data_engineer/project_study/supply_chain/supply_chain_de_study/dbt", "require_ref_searches_node_package_before_root": false, "state_modified_compare_more_unrendered_values": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format_file": "debug", "show_all_deprecations": false}}